# Elastic Load Balancer - Sticky Sessions

## Overview
Elastic Load Balancer (ELB) in AWS supports sticky sessions (also known as session affinity), a feature that ensures that all requests from a user during a session are sent to the same target. This is useful for maintaining user state information across multiple requests to a web application.

## Key Features
- **Session Stickiness**: ELB can bind a user’s session to a specific target within the target group.
- **Session Cookie**: ELB uses a special cookie to track the session.
  - **Application-Controlled Session Stickiness**: Uses an application cookie to determine the session lifetime.
  - **Duration-Based Session Stickiness**: Uses a load balancer-generated cookie to maintain session stickiness for a specified duration.

## Use Cases
- **Stateful Applications**: Ideal for applications that require stateful information, such as shopping carts, user profiles, and other personalized data.
- **User Authentication**: Helps in maintaining a user’s login session by consistently routing their requests to the same server.

## How Sticky Sessions Work
1. **Client Makes a Request**: A client initiates a session by making a request to the load balancer.
2. **Load Balancer Routes to Target**: The load balancer routes the request to one of the targets (e.g., EC2 instance) based on the load balancing algorithm.
3. **Session Cookie Issued**: The target issues a session cookie to the client, which is stored in the client’s browser.
4. **Subsequent Requests**: For subsequent requests, the load balancer checks the session cookie and routes the requests to the same target to maintain session stickiness.

## Flow Diagram for Sticky Sessions

```plaintext
+-------------------+
| Client Requests   |
+---------+---------+
          |
          V
+---------+---------+
| Elastic Load      |
| Balancer (ELB)    |
+---------+---------+
          |
          V
+---------+---------+
| Evaluate           |
|   Session Cookie  |
+---------+---------+
          |
          V
+---------+---------+
| Route to Specific |
|   Target          |
+---------+---------+
          |
          V
+---------+------+        +-------------------+
| Target (e.g., EC2)| <--> | Issue Session    |
|                   |      | Cookie           |
+-------------------+      +-------------------+
```

## Description of the Flow Diagram

1. **Client Requests**: The client initiates a session by sending a request to the ELB.
2. **Elastic Load Balancer (ELB)**: The ELB evaluates the incoming request and checks for a session cookie.
3. **Evaluate Session Cookie**: If a session cookie is present, the ELB routes the request to the specific target associated with that session.
4. **Route to Specific Target**: The ELB routes the request to the appropriate target (e.g., EC2 instance).
5. **Target Issues Session Cookie**: The target processes the request and issues a session cookie to the client, ensuring subsequent requests are routed to the same target.

## Application-based Cookies

### Custom Cookie
- Generated by the target
- Can include any custom attributes required by the application
- Cookie name must be specified individually for each target group
- Do not use `AWSALB`, `AWSALBAPP`, or `AWSALBTG` (reserved for use by the ELB)

### Application Cookie
- Generated by the load balancer
- Cookie name is `AWSALBAPP`

### Duration-based Cookies
- Cookie generated by the load balancer
- Cookie name is `AWSALB` for ALB, `AWSELB` for CLB

![image](https://github.com/user-attachments/assets/68f3448d-2413-4be8-b01e-64b4b1427e8c)
